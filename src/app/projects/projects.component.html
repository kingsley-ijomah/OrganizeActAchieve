<div class="projects-container">
  <header class="projects-header">
    <div class="projects-title-section">
      <h1 class="projects-title">Projects</h1>
      <span class="project-count-badge">{{ projects.length }} projects</span>
    </div>
    <button class="filter-btn" type="button" (click)="openFilter()" aria-label="Filter">
      <span class="material-icons">filter_list</span>
    </button>
  </header>
  
  <div class="projects-controls">
    <div class="search-row">
      <div class="search-wrapper">
        <span class="material-icons search-icon">search</span>
        <input 
          class="search-input" 
          type="text"
          placeholder="Search projects…"
          [(ngModel)]="searchQuery"
        />
        <button 
          class="clear-search-btn" 
          type="button"
          *ngIf="searchQuery"
          (click)="searchQuery = ''"
          aria-label="Clear search"
        >
          <span class="material-icons">close</span>
        </button>
      </div>
    </div>

    <div class="add-project-form" *ngIf="showAddForm">
      <input 
        class="project-name-input" 
        type="text"
        placeholder="Project name…"
        [(ngModel)]="newProjectName"
        (keydown.enter)="addProject()"
        (keydown.escape)="toggleAddForm()"
        #projectInput
      />
      <button 
        class="cancel-project-btn" 
        type="button"
        (click)="toggleAddForm()"
        aria-label="Cancel"
      >
        <span class="material-icons">close</span>
      </button>
      <button 
        class="save-project-btn" 
        type="button"
        (click)="addProject()"
        [disabled]="!newProjectName.trim()"
        aria-label="Save project"
      >
        <span class="material-icons">check</span>
      </button>
    </div>
  </div>

  <div class="projects-grid">
    <app-project-card 
      *ngFor="let project of displayedProjects" 
      [project]="project"
      (open)="openDetails(project)"
      (delete)="deleteProject($event)"
    ></app-project-card>
  </div>

  <app-load-more-button 
    [hasMore]="hasMoreProjects"
    [remainingCount]="remainingCount"
    (loadMore)="loadMore()"
  ></app-load-more-button>


  <div class="empty-state" *ngIf="filteredProjects.length === 0 && searchQuery">
    <span class="material-icons">search_off</span>
    <p>No projects found matching "{{ searchQuery }}"</p>
  </div>

  <div class="empty-state" *ngIf="projects.length === 0 && !searchQuery">
    <span class="material-icons">folder</span>
    <p>No projects yet. Create your first project to get started!</p>
  </div>

  <router-outlet></router-outlet>
</div>

<app-list-filter
  [value]="filter"
  [isOpen]="showFilter"
  (change)="onFilterChange($event)"
  (close)="closeFilter()"
></app-list-filter>

<button class="fab-projects" type="button" (click)="toggleAddForm()" *ngIf="!showAddForm" aria-label="Add new project">
  <span class="material-icons">add</span>
</button>
